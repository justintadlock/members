<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
	<title>A guide to the Members plugin</title>
	<link rel="stylesheet" href="readme.css" type="text/css" media="screen" />
</head>
<body>

<h1>A guide to the Members plugin</h1>

<p class="first">The <em>Members</em> plugin is meant to be a complete user, role, and content management plugin for WordPress. Its purpose is to give you fine-grained control over who has access to what.</p>

<p class="second">Right now, it's only in its second generation of development.  It's my hope that this plugin provides that true <acronym title="Content Management System">CMS</acronym> experience that many users long for in WordPress. There's a long road ahead, and I hope you join me for the ride.</p>

<h2>The plugin documentation</h2>

<p>Use the links below to navigate to a specific section in the documentation:</p>

<ul>
	<li><a href="#users-roles-caps">The relationship of users, roles, and capabilities</a></li>
	<li><a href="#install">How to install the plugin</a></li>
	<li><a href="#how-to">How to use the plugin</a></li>
	<li>Plugin features
		<ul>
			<li><a href="#role-manager">Role management</a>
				<ul>
					<li><a href="#edit-roles">Editing roles</a></li>
					<li><a href="#new-roles">Adding new roles</a></li>
				</ul>
			</li>
			<li><a href="#content-permissions">Content permissions</a></li>
			<li><a href="#shortcodes">Shortcodes component</a>
				<ul>
					<li><a href="#access">[access]</a></li>
					<li><a href="#is-user-logged-in">[is_user_logged_in]</a></li>
					<li><a href="#feed">[feed]</a></li>
				</ul>
			</li>
			<li><a href="#widgets">Widgets</a>
				<ul>
					<li><a href="#login-widget">Login Form widget</a></li>
					<li><a href="#users-widget">Users widget</a></li>
				</ul>
			</li>
			<li><a href="#private-blog">Private site</a></li>
		</ul>
	</li>
	<li><a href="#capability-check">Checking if the current user has a capability/role</a></li>
	<li>Plugin/theme integration for developers
		<ul>
			<li><a href="#filter-caps">Adding new capabilities</a></li>
			<li><a href="#cap-check">Checking for capabilities</a></li>
		</ul>
	</li>
	<li><a href="#old-levels">Need the old user levels system?</a></li>
	<li><a href="#plugin-support">Plugin support</a></li>
	<li><a href="#copyright">Copyright &amp; License</a></li>
</ul>

<h2 id="users-roles-caps">The relationship of users, roles, and capabilities</h2>

<p>This is the most important thing to understand with this plugin.  It's so important that I took the time out of my day to write a complete tutorial on understanding this:  <a href="http://justintadlock.com/archives/2009/08/30/users-roles-and-capabilities-in-wordpress" title="Users, roles, and capabilities in WordPress">Users, roles, and capabilities in WordPress</a>.  If you don't understand this concept, you won't understand what this plugin does.  This is not a concept created by the plugin.  This is how it's done in WordPress.</p>

<p>I highly recommend reading that blog post, but here's the short version:</p>

<ul>
	<li><strong>Users</strong> are people that have registered on your site.  I'm sure you already knew that.  In WordPress, users are assigned a specific role.  This role defines what the user can/can't do.</li>
	<li><strong>Roles</strong> are a way of grouping users.  Each user on your site will have a specific role.  Roles are a set of capabilities.  It is important to note that <strong>roles are not hierarchical</strong>.  For example, "Administrator" is not higher than "Subscriber" in WordPress.  You could literally give the Subscriber role more capabilities than the Administrator role.  It's very important that you grasp this concept.</li>
	<li><strong>Capabilities</strong> give meaning to roles.  It's a permissions system.  They're a way of saying a role <em>can</em> do something or a role <em>can't</em> do something (e.g., Role A can <code>edit_posts</code>, Role B can't <code>activate_plugins</code>, etc.).</li>
</ul>

<h2 id="install">How to install the plugin</h2>

<ol>
	<li>Uzip the <code>members.zip</code> folder.</li>
	<li>Upload the <code>members</code> folder to your <code>/wp-content/plugins</code> directory.</li>
	<li>In your WordPress dashboard, head over to the <em>Plugins</em> section.</li>
	<li>Activate <em>Members</em>.</li>
</ol>

<h2 id="how-to">How to use the plugin</h2>

<p>This plugin is set up to have a components-based system.  The reason for this is that I don't want to stick everyone with a bunch of features they don't need.  There's no point in using the Role Manger feature if all you need is just a login widget and some shortcodes.  So, it's a <em>use-only-what-you-want</em> system.</p>

<p>To activate certain features, look for the <em>Members</em> link under your <em>Settings</em> menu while in your WordPress admin.  When on the new page, you'll be able to select the features you want to use.</p>

<p>I recommend at least activating Role Manager feature.  It is at the heart of this plugin, and many other features will likely require its use in some form.</p>

<h2 id="role-manager">Role management</h2>

<p>The Role Manager feature allows you to edit and add new roles as well as add and remove both default capabilities and custom capabilities from roles.  It is an extremely powerful system.</p>

<p class="alert">Any changes you make to users and roles using this feature are permanent changes.  What I mean by this is that if you deactivate or uninstall this plugin, the changes won't revert to their previous state.  This plugin merely provides a user interface for you to make changes directly to your WordPress database.  Please use this feature wisely.</p>

<h3 id="edit-roles">Editing existing roles</h3>

<p>This feature can be both a blessing and a curse, so I'm going to ask that you use it wisely.  Use extreme caution when assigning new capabilities to roles. You wouldn't want to give Average Joe the <code>edit_plugins</code> capability, for example.</p>

<p>You can find the settings page for this feature under the <em>Users</em> menu.  It will be labeled <em>Roles</em>.  When clicking on the menu item, you'll get a list of all the available roles.  From there, you can select a role to edit.</p>

<p>When selecting a role to edit, you will be taken to a new screen that lists all of the available capabilities you can add to a role.  You simply have to tick the checkbox next to the capability you want to add/remove for a particular role and save.</p>

<h3 id="new-roles">Adding new roles</h3>

<p>The menu item for adding new roles is located under the <em>Users</em> menu and is labeled <em>Add New Role</em>.</p>

<p>Adding new roles is pretty straightforward.  You need to input a <em>Role Name</em> (only use letters, numbers, and underscores), <em>Role Label</em>, and select which capabilities the new role should have.  You can later edit this role.</p>

<p>You can assign new roles to users from the <em>Users</em> screen in WordPress.  This is nothing particular to the plugin and is a default part of WordPress.  I believe you need the <code>edit_users</code> capability to do this.</p>

<h2 id="content-permissions">Content permissions feature</h2>

<p>The <em>Content Permissions</em> feature will be the heart and soul of this plugin in the future.  Right now, it only adds an additional meta box on the post editing screen.</p>

<p>For any public post type (posts, pages, etc.), you'll see a "Content Permissions" meta box on the post editing screen.  This meta box allows you to select which roles can view the content of the post/page.  If no roles are selected, anyone can view the content.  The post author, users that can edit the post, and any users of roles with the <code>restrict_content</code> capability can <strong>always</strong> view the post, regardless of their role.</p>

<p>You can add a custom error message for individual posts.  Otherwise, the error message will default to whatever you have set under the <em>Members</em> plugin settings.</p>

<h2 id="shortcodes">Shortcodes</h2>

<p>There are several shortcodes that you can use in your post editor or any shortcode-ready area..</p>

<h3 id="access">[access]</h3>

<p>The <code>[access]</code> shortcode is for hiding content from particular roles and capabilities.  You need to wrap your content when using this shortcode:</p>

<pre><code>[access role="editor"]Hide this content from everyone but editors.[/access]</code></pre>

<p><strong>Parameters:</strong></p>

<ul>
	<li><code>capability</code>:  A capability that has been assigned to a role.</li>
	<li><code>role</code>: A user role from WordPress or one that you've created.</li>
	<li><code>feed</code>: Set to <code>true</code> if you'd like to show the content in feeds.</li>
</ul>

<p>Note that <code>capability</code> and <code>role</code> parameters aren't used in conjunction.  The code first checks for the capability (if input) then checks for the role (if input).</p>

<p>To check for multiple capabilities or multiple roles, simply add a comma between each capability/role.  For example, the following code checks for an editor or administrator:</p>

<pre><code>[access role="administrator,editor"]Hide this content from everyone but administrators and editors.[/access]</code></pre>

<h3 id="is-user-logged-in">[is_user_logged_in]</h3>

<p>The <code>[is_user_logged_in]</code> shortcode should be used to check if a user is currently logged into the site.  If not, the content will be hidden.</p>

<pre><code>[is_user_logged_in]This content is only shown to logged-in users.[/is_user_logged_in]</code></pre>

<p>This shortcode has no parameters.</p>

<h3 id="feed">[feed]</h3>

<p>If you have content you only want to show to subscribers of your feed, wrap it in this shortcode:</p>

<pre><code>[feed]This content will only be shown in feeds.[/feed]</code></pre>

<p>This shortcode has no parameters.</p>

<h2 id="widgets">Widgets</h2>

<p>The widgets component provides easy-to-use widgets for your site.  They can be used in any WordPress widget area (provided by your theme).  Currently, there's the <em>Login Form</em> and <em>Users</em> widgets.</p>

<h3 id="login-widget">Login Form widget</h3>

<p>The <em>Login Form</em> gives you a login form.  It's a mixture of a text widget and login form.  It can also show your avatar.</p>

<p>It's pretty straightforward, but I'll provide more documentation later.</p>

<h3 id="users-widget">Users widget</h3>

<p>The <em>Users</em> widget allows you to list users in any widget area.  It's based off the <code>get_users()</code> function, so all of the <a href="http://codex.wordpress.org/Function_Reference/get_users" title="WordPress Codex: get_users()">parameters are the same</a>.</p>

<h2 id="private-blog">Private site</h2>

<p>The Private Site features makes sure that only logged-in users can see anything on your site.  If a user visits your site and is not logged in, they are immediately redirected to your <code>wp-login.php</code> (WordPress login) page.</p>

<p>You also have the option of disabling the viewing of feed content and setting an error message for feed items.</p>

<h2 id="capability-check">Checking if the current user has a capability/role</h2>

<p>In plugins and your theme template files, you might sometimes need to check if the currently logged in user has permission to do something.  We do this by using the WordPress function <code>current_user_can()</code>.  The basic format looks like this:</p>

<pre><code>&lt;?php if ( current_user_can( 'capability_name' ) ) echo 'This user can do something'; ?></code></pre>

<p>For a more practical situation, let's say you created a new capability called <code>read_pages</code>.  Well, you might want to hide the content within your <code>page.php</code> template by adding this:</p>

<pre><code>&lt;?php if ( current_user_can( 'read_pages ' ) ) { ?>
	&lt;?php the_content(); ?>
&lt;?php } ?></code></pre>

<p>Only users with a role that has the <code>read_pages</code> capability will be able to see the content.</p>

<p>You can check for a specific role by inputting the role name instead of the capability name.  It works the same way.</p>

<h2 id="filter-caps">Adding new default capabilities</h2>

<p>Your plugin/theme can add new capabilities to the <em>Edit Roles</em> component if needed.  This will allow users to easily select the additional capabilities for whichever roles they choose.</p>

<pre><code>add_filter( 'members_get_capabilities', 'my_plugin_new_caps' );

function my_plugin_new_caps( $capabilities ) {

	$capabilities[] = 'cap_name_1';
	$capabilities[] = 'cap_name_2';
	$capabilities[] = 'cap_name_3';

	return $capabilities;
}</code></pre>

<p>Note that you need to respect the existing capabilities and return the original array.</p>

<h2 id="cap-check">Checking for capabilities</h2>

<p>In WordPress, you can use the <code>current_user_can()</code> function to check if the current user has a particular capability.  Since you don't know whether a user has this plugin installed, you might want to check first.</p>

<p>The <code>members_check_for_cap()</code> function (only use in admin) checks if any role has a particular capability.  This can be useful in setting up something like admin menus.  For example, you can set up a theme settings menu for users that have the <code>edit_themes</code> capability.  But, if this plugin is installed and a user has the <code>edit_my_theme</code> capability, that'll be used instead.</p>

<pre><code>if ( function_exists( 'members_check_for_cap' ) &amp;&amp; members_check_for_cap( 'some_cap' ) ) {
	/* Do something if any role has the 'some_cap' capability. */
else {
	/* Do something for people without the plugin. */
}</code></pre>

<h2 id="old-levels">Need the old user levels system?</h2>

<p>Some plugins and themes might rely on the old user level system in WordPress.  These were deprecated in WordPress version 2.1 and should not be used at all.  WordPress still has minimal legacy support for these, but I highly suggest contacting your theme/plugin author if user levels are being used.</p>

<p>By default, the levels aren't shown.  They still exist, but are tucked away behind the scenes.  While not recommended, if you need to control who has what level (levels are just capabilities), add this to your plugin or your theme's <code>functions.php</code>:</p>

<pre><code>remove_filter( 'members_get_capabilities', 'members_remove_old_levels' );</code></pre>

<h2 id="plugin-support">Plugin support</h2>

<p>I run a WordPress community called <a href="http://themehybrid.com" title="Theme Hybrid">Theme Hybrid</a>, which is where I fully support all of my WordPress projects, including plugins.  You can sign up for an account to get plugin support for a small yearly fee ($29 <acronym title="United States Dollars">USD</acronym> at the time of writing).</p>

<p>I know.  I know.  You might not want to pay for support, but just consider it a donation to the project.  To continue making cool, <acronym title="GNU General Public License">GPL</acronym>-licensed plugins and having the time to support them, I must pay the bills.</p>

<h2 id="copyright">Copyright &amp; license</h2>

<p><em>Members</em> is licensed under the <a href="http://www.gnu.org/licenses/old-licenses/gpl-2.0.html" title="GNU GPL">GNU General Public License</a>, version 2 (<acronym title="GNU General Public License">GPL</acronym>).</p>

<p>This plugin is copyrighted to <a href="http://justintadlock.com" title="Justin Tadlock">Justin Tadlock</a>.</p>

<p>2009&thinsp;&ndash;&thinsp;2012 &copy; Justin Tadlock</p>

</body>
</html>
